{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PipesContextCreator = void 0;\nconst constants_1 = require(\"@nestjs/common/constants\");\nconst shared_utils_1 = require(\"@nestjs/common/utils/shared.utils\");\nconst iterare_1 = require(\"iterare\");\nconst context_creator_1 = require(\"../helpers/context-creator\");\nconst constants_2 = require(\"../injector/constants\");\nclass PipesContextCreator extends context_creator_1.ContextCreator {\n  constructor(container, config) {\n    super();\n    this.container = container;\n    this.config = config;\n  }\n  create(instance, callback, moduleKey, contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n    this.moduleContext = moduleKey;\n    return this.createContext(instance, callback, constants_1.PIPES_METADATA, contextId, inquirerId);\n  }\n  createConcreteContext(metadata, contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n    if ((0, shared_utils_1.isEmpty)(metadata)) {\n      return [];\n    }\n    return (0, iterare_1.iterate)(metadata).filter(pipe => pipe && (pipe.name || pipe.transform)).map(pipe => this.getPipeInstance(pipe, contextId, inquirerId)).filter(pipe => pipe && pipe.transform && (0, shared_utils_1.isFunction)(pipe.transform)).toArray();\n  }\n  getPipeInstance(pipe, contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n    const isObject = pipe.transform;\n    if (isObject) {\n      return pipe;\n    }\n    const instanceWrapper = this.getInstanceByMetatype(pipe);\n    if (!instanceWrapper) {\n      return null;\n    }\n    const instanceHost = instanceWrapper.getInstanceByContextId(this.getContextId(contextId, instanceWrapper), inquirerId);\n    return instanceHost && instanceHost.instance;\n  }\n  getInstanceByMetatype(metatype) {\n    if (!this.moduleContext) {\n      return;\n    }\n    const collection = this.container.getModules();\n    const moduleRef = collection.get(this.moduleContext);\n    if (!moduleRef) {\n      return;\n    }\n    return moduleRef.injectables.get(metatype);\n  }\n  getGlobalMetadata(contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n    if (!this.config) {\n      return [];\n    }\n    const globalPipes = this.config.getGlobalPipes();\n    if (contextId === constants_2.STATIC_CONTEXT && !inquirerId) {\n      return globalPipes;\n    }\n    const scopedPipeWrappers = this.config.getGlobalRequestPipes();\n    const scopedPipes = (0, iterare_1.iterate)(scopedPipeWrappers).map(wrapper => wrapper.getInstanceByContextId(this.getContextId(contextId, wrapper), inquirerId)).filter(host => !!host).map(host => host.instance).toArray();\n    return globalPipes.concat(scopedPipes);\n  }\n  setModuleContext(context) {\n    this.moduleContext = context;\n  }\n}\nexports.PipesContextCreator = PipesContextCreator;","map":{"version":3,"names":["Object","defineProperty","exports","value","PipesContextCreator","constants_1","require","shared_utils_1","iterare_1","context_creator_1","constants_2","ContextCreator","constructor","container","config","create","instance","callback","moduleKey","contextId","STATIC_CONTEXT","inquirerId","moduleContext","createContext","PIPES_METADATA","createConcreteContext","metadata","isEmpty","iterate","filter","pipe","name","transform","map","getPipeInstance","isFunction","toArray","isObject","instanceWrapper","getInstanceByMetatype","instanceHost","getInstanceByContextId","getContextId","metatype","collection","getModules","moduleRef","get","injectables","getGlobalMetadata","globalPipes","getGlobalPipes","scopedPipeWrappers","getGlobalRequestPipes","scopedPipes","wrapper","host","concat","setModuleContext","context"],"sources":["C:/Users/salim/Dev/avans-nx-workshop-2024/avans-nx-workshop/node_modules/@nestjs/core/pipes/pipes-context-creator.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PipesContextCreator = void 0;\nconst constants_1 = require(\"@nestjs/common/constants\");\nconst shared_utils_1 = require(\"@nestjs/common/utils/shared.utils\");\nconst iterare_1 = require(\"iterare\");\nconst context_creator_1 = require(\"../helpers/context-creator\");\nconst constants_2 = require(\"../injector/constants\");\nclass PipesContextCreator extends context_creator_1.ContextCreator {\n    constructor(container, config) {\n        super();\n        this.container = container;\n        this.config = config;\n    }\n    create(instance, callback, moduleKey, contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n        this.moduleContext = moduleKey;\n        return this.createContext(instance, callback, constants_1.PIPES_METADATA, contextId, inquirerId);\n    }\n    createConcreteContext(metadata, contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n        if ((0, shared_utils_1.isEmpty)(metadata)) {\n            return [];\n        }\n        return (0, iterare_1.iterate)(metadata)\n            .filter((pipe) => pipe && (pipe.name || pipe.transform))\n            .map(pipe => this.getPipeInstance(pipe, contextId, inquirerId))\n            .filter(pipe => pipe && pipe.transform && (0, shared_utils_1.isFunction)(pipe.transform))\n            .toArray();\n    }\n    getPipeInstance(pipe, contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n        const isObject = pipe.transform;\n        if (isObject) {\n            return pipe;\n        }\n        const instanceWrapper = this.getInstanceByMetatype(pipe);\n        if (!instanceWrapper) {\n            return null;\n        }\n        const instanceHost = instanceWrapper.getInstanceByContextId(this.getContextId(contextId, instanceWrapper), inquirerId);\n        return instanceHost && instanceHost.instance;\n    }\n    getInstanceByMetatype(metatype) {\n        if (!this.moduleContext) {\n            return;\n        }\n        const collection = this.container.getModules();\n        const moduleRef = collection.get(this.moduleContext);\n        if (!moduleRef) {\n            return;\n        }\n        return moduleRef.injectables.get(metatype);\n    }\n    getGlobalMetadata(contextId = constants_2.STATIC_CONTEXT, inquirerId) {\n        if (!this.config) {\n            return [];\n        }\n        const globalPipes = this.config.getGlobalPipes();\n        if (contextId === constants_2.STATIC_CONTEXT && !inquirerId) {\n            return globalPipes;\n        }\n        const scopedPipeWrappers = this.config.getGlobalRequestPipes();\n        const scopedPipes = (0, iterare_1.iterate)(scopedPipeWrappers)\n            .map(wrapper => wrapper.getInstanceByContextId(this.getContextId(contextId, wrapper), inquirerId))\n            .filter(host => !!host)\n            .map(host => host.instance)\n            .toArray();\n        return globalPipes.concat(scopedPipes);\n    }\n    setModuleContext(context) {\n        this.moduleContext = context;\n    }\n}\nexports.PipesContextCreator = PipesContextCreator;\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,mBAAmB,GAAG,KAAK,CAAC;AACpC,MAAMC,WAAW,GAAGC,OAAO,CAAC,0BAA0B,CAAC;AACvD,MAAMC,cAAc,GAAGD,OAAO,CAAC,mCAAmC,CAAC;AACnE,MAAME,SAAS,GAAGF,OAAO,CAAC,SAAS,CAAC;AACpC,MAAMG,iBAAiB,GAAGH,OAAO,CAAC,4BAA4B,CAAC;AAC/D,MAAMI,WAAW,GAAGJ,OAAO,CAAC,uBAAuB,CAAC;AACpD,MAAMF,mBAAmB,SAASK,iBAAiB,CAACE,cAAc,CAAC;EAC/DC,WAAWA,CAACC,SAAS,EAAEC,MAAM,EAAE;IAC3B,KAAK,CAAC,CAAC;IACP,IAAI,CAACD,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACC,MAAM,GAAGA,MAAM;EACxB;EACAC,MAAMA,CAACC,QAAQ,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,SAAS,GAAGT,WAAW,CAACU,cAAc,EAAEC,UAAU,EAAE;IACtF,IAAI,CAACC,aAAa,GAAGJ,SAAS;IAC9B,OAAO,IAAI,CAACK,aAAa,CAACP,QAAQ,EAAEC,QAAQ,EAAEZ,WAAW,CAACmB,cAAc,EAAEL,SAAS,EAAEE,UAAU,CAAC;EACpG;EACAI,qBAAqBA,CAACC,QAAQ,EAAEP,SAAS,GAAGT,WAAW,CAACU,cAAc,EAAEC,UAAU,EAAE;IAChF,IAAI,CAAC,CAAC,EAAEd,cAAc,CAACoB,OAAO,EAAED,QAAQ,CAAC,EAAE;MACvC,OAAO,EAAE;IACb;IACA,OAAO,CAAC,CAAC,EAAElB,SAAS,CAACoB,OAAO,EAAEF,QAAQ,CAAC,CAClCG,MAAM,CAAEC,IAAI,IAAKA,IAAI,KAAKA,IAAI,CAACC,IAAI,IAAID,IAAI,CAACE,SAAS,CAAC,CAAC,CACvDC,GAAG,CAACH,IAAI,IAAI,IAAI,CAACI,eAAe,CAACJ,IAAI,EAAEX,SAAS,EAAEE,UAAU,CAAC,CAAC,CAC9DQ,MAAM,CAACC,IAAI,IAAIA,IAAI,IAAIA,IAAI,CAACE,SAAS,IAAI,CAAC,CAAC,EAAEzB,cAAc,CAAC4B,UAAU,EAAEL,IAAI,CAACE,SAAS,CAAC,CAAC,CACxFI,OAAO,CAAC,CAAC;EAClB;EACAF,eAAeA,CAACJ,IAAI,EAAEX,SAAS,GAAGT,WAAW,CAACU,cAAc,EAAEC,UAAU,EAAE;IACtE,MAAMgB,QAAQ,GAAGP,IAAI,CAACE,SAAS;IAC/B,IAAIK,QAAQ,EAAE;MACV,OAAOP,IAAI;IACf;IACA,MAAMQ,eAAe,GAAG,IAAI,CAACC,qBAAqB,CAACT,IAAI,CAAC;IACxD,IAAI,CAACQ,eAAe,EAAE;MAClB,OAAO,IAAI;IACf;IACA,MAAME,YAAY,GAAGF,eAAe,CAACG,sBAAsB,CAAC,IAAI,CAACC,YAAY,CAACvB,SAAS,EAAEmB,eAAe,CAAC,EAAEjB,UAAU,CAAC;IACtH,OAAOmB,YAAY,IAAIA,YAAY,CAACxB,QAAQ;EAChD;EACAuB,qBAAqBA,CAACI,QAAQ,EAAE;IAC5B,IAAI,CAAC,IAAI,CAACrB,aAAa,EAAE;MACrB;IACJ;IACA,MAAMsB,UAAU,GAAG,IAAI,CAAC/B,SAAS,CAACgC,UAAU,CAAC,CAAC;IAC9C,MAAMC,SAAS,GAAGF,UAAU,CAACG,GAAG,CAAC,IAAI,CAACzB,aAAa,CAAC;IACpD,IAAI,CAACwB,SAAS,EAAE;MACZ;IACJ;IACA,OAAOA,SAAS,CAACE,WAAW,CAACD,GAAG,CAACJ,QAAQ,CAAC;EAC9C;EACAM,iBAAiBA,CAAC9B,SAAS,GAAGT,WAAW,CAACU,cAAc,EAAEC,UAAU,EAAE;IAClE,IAAI,CAAC,IAAI,CAACP,MAAM,EAAE;MACd,OAAO,EAAE;IACb;IACA,MAAMoC,WAAW,GAAG,IAAI,CAACpC,MAAM,CAACqC,cAAc,CAAC,CAAC;IAChD,IAAIhC,SAAS,KAAKT,WAAW,CAACU,cAAc,IAAI,CAACC,UAAU,EAAE;MACzD,OAAO6B,WAAW;IACtB;IACA,MAAME,kBAAkB,GAAG,IAAI,CAACtC,MAAM,CAACuC,qBAAqB,CAAC,CAAC;IAC9D,MAAMC,WAAW,GAAG,CAAC,CAAC,EAAE9C,SAAS,CAACoB,OAAO,EAAEwB,kBAAkB,CAAC,CACzDnB,GAAG,CAACsB,OAAO,IAAIA,OAAO,CAACd,sBAAsB,CAAC,IAAI,CAACC,YAAY,CAACvB,SAAS,EAAEoC,OAAO,CAAC,EAAElC,UAAU,CAAC,CAAC,CACjGQ,MAAM,CAAC2B,IAAI,IAAI,CAAC,CAACA,IAAI,CAAC,CACtBvB,GAAG,CAACuB,IAAI,IAAIA,IAAI,CAACxC,QAAQ,CAAC,CAC1BoB,OAAO,CAAC,CAAC;IACd,OAAOc,WAAW,CAACO,MAAM,CAACH,WAAW,CAAC;EAC1C;EACAI,gBAAgBA,CAACC,OAAO,EAAE;IACtB,IAAI,CAACrC,aAAa,GAAGqC,OAAO;EAChC;AACJ;AACAzD,OAAO,CAACE,mBAAmB,GAAGA,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}