{"ast":null,"code":"\"use strict\";\n\nvar _asyncToGenerator = require(\"C:/Users/salim/Dev/avans-nx-workshop-2024/avans-nx-workshop/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FileInterceptor = FileInterceptor;\nconst tslib_1 = require(\"tslib\");\nconst common_1 = require(\"@nestjs/common\");\nconst multer = require(\"multer\");\nconst files_constants_1 = require(\"../files.constants\");\nconst multer_utils_1 = require(\"../multer/multer.utils\");\n/**\n * @param fieldName\n * @param localOptions\n *\n * @publicApi\n */\nfunction FileInterceptor(fieldName, localOptions) {\n  let MixinInterceptor = class MixinInterceptor {\n    constructor(options = {}) {\n      this.multer = multer({\n        ...options,\n        ...localOptions\n      });\n    }\n    intercept(context, next) {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const ctx = context.switchToHttp();\n        yield new Promise((resolve, reject) => _this.multer.single(fieldName)(ctx.getRequest(), ctx.getResponse(), err => {\n          if (err) {\n            const error = (0, multer_utils_1.transformException)(err);\n            return reject(error);\n          }\n          resolve();\n        }));\n        return next.handle();\n      })();\n    }\n  };\n  MixinInterceptor = tslib_1.__decorate([tslib_1.__param(0, (0, common_1.Optional)()), tslib_1.__param(0, (0, common_1.Inject)(files_constants_1.MULTER_MODULE_OPTIONS)), tslib_1.__metadata(\"design:paramtypes\", [Object])], MixinInterceptor);\n  const Interceptor = (0, common_1.mixin)(MixinInterceptor);\n  return Interceptor;\n}","map":{"version":3,"names":["_asyncToGenerator","require","default","Object","defineProperty","exports","value","FileInterceptor","tslib_1","common_1","multer","files_constants_1","multer_utils_1","fieldName","localOptions","MixinInterceptor","constructor","options","intercept","context","next","_this","ctx","switchToHttp","Promise","resolve","reject","single","getRequest","getResponse","err","error","transformException","handle","__decorate","__param","Optional","Inject","MULTER_MODULE_OPTIONS","__metadata","Interceptor","mixin"],"sources":["C:/Users/salim/Dev/avans-nx-workshop-2024/avans-nx-workshop/node_modules/@nestjs/platform-express/multer/interceptors/file.interceptor.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FileInterceptor = FileInterceptor;\nconst tslib_1 = require(\"tslib\");\nconst common_1 = require(\"@nestjs/common\");\nconst multer = require(\"multer\");\nconst files_constants_1 = require(\"../files.constants\");\nconst multer_utils_1 = require(\"../multer/multer.utils\");\n/**\n * @param fieldName\n * @param localOptions\n *\n * @publicApi\n */\nfunction FileInterceptor(fieldName, localOptions) {\n    let MixinInterceptor = class MixinInterceptor {\n        constructor(options = {}) {\n            this.multer = multer({\n                ...options,\n                ...localOptions,\n            });\n        }\n        async intercept(context, next) {\n            const ctx = context.switchToHttp();\n            await new Promise((resolve, reject) => this.multer.single(fieldName)(ctx.getRequest(), ctx.getResponse(), (err) => {\n                if (err) {\n                    const error = (0, multer_utils_1.transformException)(err);\n                    return reject(error);\n                }\n                resolve();\n            }));\n            return next.handle();\n        }\n    };\n    MixinInterceptor = tslib_1.__decorate([\n        tslib_1.__param(0, (0, common_1.Optional)()),\n        tslib_1.__param(0, (0, common_1.Inject)(files_constants_1.MULTER_MODULE_OPTIONS)),\n        tslib_1.__metadata(\"design:paramtypes\", [Object])\n    ], MixinInterceptor);\n    const Interceptor = (0, common_1.mixin)(MixinInterceptor);\n    return Interceptor;\n}\n"],"mappings":"AAAA,YAAY;;AAAC,IAAAA,iBAAA,GAAAC,OAAA,wHAAAC,OAAA;AACbC,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,eAAe,GAAGA,eAAe;AACzC,MAAMC,OAAO,GAAGP,OAAO,CAAC,OAAO,CAAC;AAChC,MAAMQ,QAAQ,GAAGR,OAAO,CAAC,gBAAgB,CAAC;AAC1C,MAAMS,MAAM,GAAGT,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAMU,iBAAiB,GAAGV,OAAO,CAAC,oBAAoB,CAAC;AACvD,MAAMW,cAAc,GAAGX,OAAO,CAAC,wBAAwB,CAAC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,SAASM,eAAeA,CAACM,SAAS,EAAEC,YAAY,EAAE;EAC9C,IAAIC,gBAAgB,GAAG,MAAMA,gBAAgB,CAAC;IAC1CC,WAAWA,CAACC,OAAO,GAAG,CAAC,CAAC,EAAE;MACtB,IAAI,CAACP,MAAM,GAAGA,MAAM,CAAC;QACjB,GAAGO,OAAO;QACV,GAAGH;MACP,CAAC,CAAC;IACN;IACMI,SAASA,CAACC,OAAO,EAAEC,IAAI,EAAE;MAAA,IAAAC,KAAA;MAAA,OAAArB,iBAAA;QAC3B,MAAMsB,GAAG,GAAGH,OAAO,CAACI,YAAY,CAAC,CAAC;QAClC,MAAM,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAKL,KAAI,CAACX,MAAM,CAACiB,MAAM,CAACd,SAAS,CAAC,CAACS,GAAG,CAACM,UAAU,CAAC,CAAC,EAAEN,GAAG,CAACO,WAAW,CAAC,CAAC,EAAGC,GAAG,IAAK;UAC/G,IAAIA,GAAG,EAAE;YACL,MAAMC,KAAK,GAAG,CAAC,CAAC,EAAEnB,cAAc,CAACoB,kBAAkB,EAAEF,GAAG,CAAC;YACzD,OAAOJ,MAAM,CAACK,KAAK,CAAC;UACxB;UACAN,OAAO,CAAC,CAAC;QACb,CAAC,CAAC,CAAC;QACH,OAAOL,IAAI,CAACa,MAAM,CAAC,CAAC;MAAC;IACzB;EACJ,CAAC;EACDlB,gBAAgB,GAAGP,OAAO,CAAC0B,UAAU,CAAC,CAClC1B,OAAO,CAAC2B,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE1B,QAAQ,CAAC2B,QAAQ,EAAE,CAAC,CAAC,EAC5C5B,OAAO,CAAC2B,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE1B,QAAQ,CAAC4B,MAAM,EAAE1B,iBAAiB,CAAC2B,qBAAqB,CAAC,CAAC,EACjF9B,OAAO,CAAC+B,UAAU,CAAC,mBAAmB,EAAE,CAACpC,MAAM,CAAC,CAAC,CACpD,EAAEY,gBAAgB,CAAC;EACpB,MAAMyB,WAAW,GAAG,CAAC,CAAC,EAAE/B,QAAQ,CAACgC,KAAK,EAAE1B,gBAAgB,CAAC;EACzD,OAAOyB,WAAW;AACtB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}